@{
    Layout = null;
    var candi = ViewBag.Candidate as FindJob.Models.EF.Candidate;
    var Skill = ViewBag.Skill as List<FindJob.Models.EF.Skill>;
    var Education = ViewBag.Education as List<FindJob.Models.EF.Education>;
    var Experience = ViewBag.Experience as List<FindJob.Models.EF.Experience>;
    int dem = 0, dem_1 = 0;
}


@if (Skill.Count == 0 || Education.Count == 0 || Experience.Count == 0)
{
    ViewBag.Title = "Tạo CV online";
    Layout = "~/Views/Shared/_Layout.cshtml";
    <section id="jobs" style="margin-top: 140px">
        <div class="container">
            <div class="row text-center">
                <div class="col-sm-12">
                    <h1>Tạo CV online</h1>
                    <h4>Bạn chưa tạo CV.</h4>
                    <div class="jumbotron">
                        <h3>Bạn chưa tạo CV?</h3>
                        <p>Bạn vui lòng nhập thông tin để tạo CV tại đây</p>
                        <p><a href="/User/Created_CV" class="btn btn-primary">Tạo CV</a></p>
                    </div>
                </div>
            </div>
        </div>
    </section>
}
else
{

    <!DOCTYPE html>
    <html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>CV của bạn | Jobseek</title>
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="crossorigin" />
        <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&amp;family=Roboto:wght@300;400;500;700&amp;display=swap" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&amp;family=Roboto:wght@300;400;500;700&amp;display=swap" media="print" onload="this.media='all'" />
        <noscript>
            <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&amp;family=Roboto:wght@300;400;500;700&amp;display=swap" />
        </noscript>
        <link href="~/Assets/cv/css/font-awesome/css/all.min.css?ver=1.2.0" rel="stylesheet">
        <link href="~/Assets/cv/css/bootstrap.min.css?ver=1.2.0" rel="stylesheet">
        <link href="~/Assets/datepicker/datepicker3.css" rel="stylesheet" />
        <link href="~/Assets/cv/css/aos.css?ver=1.2.0" rel="stylesheet">
        <link href="~/Assets/cv/css/main.css?ver=1.2.0" rel="stylesheet">

        <link href="~/Assets/Notify/css/BrightTheme.css" rel="stylesheet" />
        <link href="~/Assets/Notify/css/PNotify.css" rel="stylesheet" />
        <link href="~/Assets/Notify/css/PNotifyBootstrap3.css" rel="stylesheet" />
        <link href="~/Assets/Notify/css/PNotifyConfirm.css" rel="stylesheet" />
        <script src="~/Assets/Notify/js/PNotifyConfirm.js"></script>
        <script src="~/Assets/Notify/js/PNotify.js"></script>
        <script src="~/Assets/Notify/js/PNotifyBootstrap3.js"></script>
        <noscript>
            <style type="text/css">
                [data-aos] {
                    opacity: 1 !important;
                    transform: translate(0) scale(1) !important;
                }
            </style>
        </noscript>
    </head>
    <body id="top">
        <div class="page-content">
            <div class="container">
                <div class="cover shadow-lg bg-white">
                    <div class="cover-bg p-3 p-lg-4 text-white">
                        <div class="row">
                            <div class="col-lg-4 col-md-5">
                                <div class="avatar hover-effect bg-white shadow-sm p-1"><img src="~/Assets/images/candidate/@candi.Image" width="200" height="200" /></div>
                            </div>
                            <div class="col-lg-8 col-md-7 text-center text-md-start">
                                <h2 class="h1 mt-2" data-aos="fade-left" data-aos-delay="0">@candi.Fullname</h2>
                                <p data-aos="fade-left" data-aos-delay="100">@candi.MainSkill</p>
                                <div class="d-print-none" data-aos="fade-left" data-aos-delay="200">
                                    <a class="btn btn-light text-dark shadow-sm mt-1 me-1" href="/User/Print/@candi.ID" target="_blank">Download CV</a>
                                    <a class="btn btn-success shadow-sm mt-1" href="/User/Edit_CV/@candi.ID">Sửa CV</a>
                                    <a class="btn btn-danger shadow-sm mt-1" id="Delete" href="#" data-id="@candi.ID">Xóa CV</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="about-section pt-4 px-3 px-lg-4 mt-1">
                        <div class="row">
                            <div class="col-md-6">
                                <h2 class="h3 mb-3">Giới thiệu</h2>
                                @Html.Raw(candi.Introduce)
                            </div>
                            <div class="col-md-5 offset-md-1">
                                <div class="row mt-2">
                                    <div class="col-sm-4">
                                        <div class="pb-1">Ngày sinh</div>
                                    </div>
                                    <div class="col-sm-8">
                                        <div class="pb-1 text-secondary">@candi.Birthday.Value.ToString("dd/MM/yyyy")</div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="pb-1">Email</div>
                                    </div>
                                    <div class="col-sm-8">
                                        <div class="pb-1 text-secondary">@candi.Email</div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="pb-1">Điện thoại</div>
                                    </div>
                                    <div class="col-sm-8">
                                        <div class="pb-1 text-secondary">@candi.Phone</div>
                                    </div>
                                    <div class="col-sm-4">
                                        <div class="pb-1">Địa chỉ</div>
                                    </div>
                                    <div class="col-sm-8">
                                        <div class="pb-1 text-secondary">@candi.Address</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr class="d-print-none" />
                    <div class="skills-section px-3 px-lg-4">
                        <h2 class="h3 mb-3">Kỹ năng nổi bật</h2>
                        <div class="row">
                            <div class="col-md-6">
                                @foreach (var item in Skill)
                                {
                                    dem++;
                                    if (dem <= 3)
                                    {
                                        <div class="mb-2">
                                            <span>@item.MainSkill</span>
                                            <div class="progress my-1">
                                                <div class="progress-bar bg-primary" role="progressbar" data-aos="zoom-in-right" data-aos-delay="100" data-aos-anchor=".skills-section" style="width: @item.Level%" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                    }
                                }
                            </div>
                            <div class="col-md-6">
                                @foreach (var item in Skill)
                                {
                                    dem_1++;
                                    if (Skill.Count > 3 && dem_1 > 3)
                                    {
                                        <div class="mb-2">
                                            <span>@item.MainSkill</span>
                                            <div class="progress my-1">
                                                <div class="progress-bar bg-success" role="progressbar" data-aos="zoom-in-right" data-aos-delay="100" data-aos-anchor=".skills-section" style="width: @item.Level%" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                    }
                                }
                            </div>
                        </div>
                    </div>
                    <hr class="d-print-none" />
                    <div class="work-experience-section px-3 px-lg-4">
                        <h2 class="h3 mb-4">Kinh nghiệm làm việc</h2>
                        <div class="timeline">
                            @foreach (var item in Experience)
                            {
                                <div class="timeline-card timeline-card-primary card shadow-sm">
                                    <div class="card-body">
                                        <div class="h5 mb-1">@item.Position <span class="text-muted h6">tại @item.Place</span></div>
                                        <div class="text-muted text-small mb-2">@item.FromDate.Value.ToString("MM/yyyy") - @(item.ToDate.Value.ToString("MM/yyyy") == DateTime.Now.ToString("MM/yyyy") ? "Nay" : item.ToDate.Value.ToString("MM/yyyy"))</div>
                                        <div>
                                            @item.Descriptions
                                        </div>
                                    </div>
                                </div>
                            }

                        </div>
                    </div>
                    <hr class="d-print-none" />
                    <div class="page-break"></div>
                    <div class="education-section px-3 px-lg-4 pb-4">
                        <h2 class="h3 mb-4">Học vấn</h2>
                        <div class="timeline">
                            @foreach (var item in Education)
                            {
                                <div class="timeline-card timeline-card-success card shadow-sm">
                                    <div class="card-body">
                                        <div class="h5 mb-1">@item.Education1 <span class="text-muted h6">tại @item.School</span></div>
                                        <div class="text-muted text-small mb-2">@item.FromDate.Value.ToString("yyyy") - @(item.ToDate.Value.ToString("yyyy") == DateTime.Now.ToString("yyyy") ? "Nay" : item.ToDate.Value.ToString("yyyy"))</div>
                                        <div>
                                            @item.Descriptions
                                        </div>
                                    </div>
                                </div>
                            }

                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script src="~/Scripts/jquery-3.3.1.min.js"></script>
        <script src="~/Assets/cv/scripts/bootstrap.bundle.min.js?ver=1.2.0"></script>
        <script src="~/Assets/datepicker/bootstrap-datepicker.js"></script>
        <script src="~/Scripts/jquery.validate.min.js"></script>
        <script src="~/Assets/cv/scripts/aos.js?ver=1.2.0"></script>
        <script src="~/Assets/cv/scripts/main.js?ver=1.2.0"></script>
        <script>
            $(function () {

                $('#Delete').off('click').on('click', function () {
                    const notice = PNotify.notice({
                        title: 'Thông báo',
                        text: 'Bạn thật sự muốn xóa?',
                        icon: 'fa fa-question-circle',
                        width: '360px',
                        minHeight: '110px',
                        hide: false,
                        closer: false,
                        sticker: false,
                        destroy: true,
                        stack: new PNotify.Stack({
                            dir1: 'down',
                            modal: true,
                            firstpos1: 25,
                            overlayClose: false
                        }),
                        modules: new Map([
                            ...PNotify.defaultModules,
                            [PNotifyConfirm, {
                                confirm: true
                            }]
                        ])
                    });

                    notice.on('pnotify:confirm', () =>
                        $.ajax({
                            data: { ID: $(this).data('id') },
                            url: '/User/DeleteCV',
                            dataType: 'Json',
                            type: 'POST',
                            success: function (res) {
                                if (res.status == true) {
                                    window.location.href = "/User/CV";
                                    PNotify.success({
                                        title: 'THÔNG BÁO!!',
                                        text: 'Xóa CV thành công.'
                                    });
                                }
                            }
                        })

                    );


                });
            });
        </script>
    </body>
</html>
}

